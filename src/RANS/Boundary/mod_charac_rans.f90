!============================================================================
module mod_charac_rans
!============================================================================
  !> author: CM
  !> date: March 2022
  !> Homogeneous Neumann boundary condition
!=============================================================================
  use mod_flow
  use mod_rans
  implicit none
  !---------------------------------------------------------------------------

contains

  !===============================================================================
  subroutine bc_imin_rans
  !===============================================================================
    !> BC: boundary condition at imax (right)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of left boundary
    ! ======================
    i=1

    do k=1,nz
       do j=1,ny
          nutil(i,j,k) = 1.0_wp/3.0_wp*(4.0_wp*nutil(i+1,j,k)-nutil(i+2,j,k) &
                       + (nutil(i,j+1,k)-nutil(i,j-1,k))*gksigeta_imin(j))
       enddo
    enddo

  end subroutine bc_imin_rans

  !===============================================================================
  subroutine bc_imax_rans
  !===============================================================================
    !> BC: boundary condition at imax (right)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of right boundary
    ! =======================
    i=nx

    do k=1,nz
       do j=1,ny
          nutil(i,j,k) = 1.0_wp/3.0_wp*(4.0_wp*nutil(i-1,j,k)-nutil(i-2,j,k) &
                       + (nutil(i,j+1,k)-nutil(i,j-1,k))*gksigeta_imax(j))
       enddo
    enddo

  end subroutine bc_imax_rans

  !===============================================================================
  subroutine bc_jmin_rans
  !===============================================================================
    !> BC: boundary condition at jmin (bottom)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of bottom boundary
    ! ========================
    j=1

    do k=1,nz
       do i=1,nx
          nutil(i,j,k) = 1.0_wp/3.0_wp*(4.0_wp*nutil(i,j+1,k)-nutil(i,j+2,k) &
                       + (nutil(i+1,j,k)-nutil(i-1,j,k))*gksigeta_jmin(i))
       enddo
    enddo

  end subroutine bc_jmin_rans

  !===============================================================================
  subroutine bc_jmax_rans
  !===============================================================================
    !> BC: boundary condition at jmax (top) 
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of top boundary
    ! =====================
    j=ny

    do k=1,nz
       do i=1,nx
          nutil(i,j,k) = 1.0_wp/3.0_wp*(4.0_wp*nutil(i,j-1,k)-nutil(i,j-2,k) &
                       + (nutil(i+1,j,k)-nutil(i-1,j,k))*gksigeta_jmax(i))
       enddo
    enddo

  end subroutine bc_jmax_rans

end module mod_charac_rans
