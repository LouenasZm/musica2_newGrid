!============================================================================
module mod_inlet_rans
!============================================================================
  !> author: CM
  !> date: March 2022
  !> Inlet boundary condition
!=============================================================================
  use mod_flow
  use mod_rans
  use mod_constant
  use mod_flow
  use mod_mpi
  implicit none
  !---------------------------------------------------------------------------

contains

  !===============================================================================
  subroutine inlet_imin_rans
  !===============================================================================
    !> BC: boundary condition at imax (right)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of left boundary
    ! ======================
    i=1

    do k=1,nz
       do j=1,ny
          nutil_n(i,j,k)=Nutref
          Knutil(i,j,k) = 0.0_wp
       enddo
    enddo

  end subroutine inlet_imin_rans

  !===============================================================================
  subroutine inlet_imax_rans
  !===============================================================================
    !> BC: boundary condition at imax (right)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of right boundary
    ! =======================
    i=nx

    do k=1,nz
       do j=1,ny
          nutil_n(i,j,k)=Nutref
          Knutil(i,j,k) = 0.0_wp
       enddo
    enddo

    if (STBL) then
       do k=1,nz
          do j=1,ny
             nutil_n(i,j,k)=nutil_n(i-1,j,k)
             Knutil(i,j,k) = 0.0_wp
          enddo
       enddo
    endif

  end subroutine inlet_imax_rans

  !===============================================================================
  subroutine inlet_jmin_rans
  !===============================================================================
    !> BC: boundary condition at jmin (bottom)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of bottom boundary
    ! ========================
    j=1

    do k=1,nz
       do i=1,nx
          nutil_n(i,j,k)=Nutref
          Knutil(i,j,k) = 0.0_wp
       enddo
    enddo

  end subroutine inlet_jmin_rans

  !===============================================================================
  subroutine inlet_jmax_rans
  !===============================================================================
    !> BC: boundary condition at jmax (top) 
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of top boundary
    ! =====================
    j=ny

    do k=1,nz
       do i=1,nx
          nutil_n(i,j,k)=Nutref
          Knutil(i,j,k) = 0.0_wp
       enddo
    enddo

    if (STBL) then
       do k=1,nz
          do i=1,nx
             nutil_n(i,j,k)=nutil_n(i,j-1,k)
             Knutil(i,j,k) = 0.0_wp
          enddo
       enddo
    endif

  end subroutine inlet_jmax_rans

  !===============================================================================
  subroutine inlet_kmin_rans
  !===============================================================================
    !> BC: boundary condition at kmin (bottom)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of bottom boundary
    ! ========================
    k=1

    do j=1,ny
       do i=1,nx
          nutil_n(i,j,k)=Nutref
          Knutil(i,j,k) = 0.0_wp
       enddo
    enddo

  end subroutine inlet_kmin_rans

  !===============================================================================
  subroutine inlet_kmax_rans
  !===============================================================================
    !> BC: boundary condition at kmax (bottom)
  !===============================================================================
    implicit none
    ! ---------------------------------------------------------------------------
    integer :: i,j,k
    ! ---------------------------------------------------------------------------
    ! Index of bottom boundary
    ! ========================
    k=nz

    do j=1,ny
       do i=1,nx
          nutil_n(i,j,k)=Nutref
          Knutil(i,j,k) = 0.0_wp
       enddo
    enddo

  end subroutine inlet_kmax_rans

end module mod_inlet_rans

